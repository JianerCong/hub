cmake_minimum_required(VERSION 3.21)
project(hi VERSION 1.1)

# Define an option. Turn this on before configure_file
option(USE_MYLIB "Use the function in mylib" ON)
# Or Use: cmake build .. -DUSE_MYLIB=OFF
# to turn it off


# Create the mConfig.h file from m.h.in
configure_file(m.h.in mConfig.h)


if(USE_MYLIB)
  add_subdirectory(mylib)         #add the ./mylib to the path
  list(APPEND EXTRA_LIBS mylib)
  list(APPEND EXTRA_INCLUDES "${PROJECT_SOURCE_DIR}/mylib")
endif()


# add an executable
add_executable(M m.cpp)

target_link_libraries(M PUBLIC ${EXTRA_LIBS})


## æ•™ç¨‹è™½è®©æˆ‘ä»¬è¿™ä¹ˆåšï¼Œä½†æ˜¯å¥½åƒåœ¨m.cppä¹‹ä¸­å¹¶ä¸éœ€è¦m.h..
## ä½†æ˜¯ï¼Œæˆ‘ä»¬è¿˜æ˜¯éœ€è¦è¿™ä¸ªï¼Œå› ä¸ºmConfig.håœ¨è¿™ä¸ªä¹‹ä¸­ã€‚
target_include_directories(M PUBLIC
  "${PROJECT_BINARY_DIR}"       #where the m.h, mConfig.h is created
  ${EXTRA_INCLUDES}
  )

# run the M target with arguments "1" (ALL means always build this target)
add_custom_target(run ALL M 1 COMMENT "Runing App ğŸ¸")
