\documentclass[dvipsnames]{article}
% \documentclass[dvipsnames]{ctexart}

\title{Openstack}
\input{h}
\input{h-says}


% --------------------------------------------------
\begin{document}
\maketitle

\section{Consideration}

\subsection{The logical architecture}

\cSay{ OpenStack uses a microservice architecture. So it's composed of many many services. }

About this services:

\begin{itemize}
\item Most of them of them are written in \cola{Python}.
\item All of them provide a \cola{REST API}.
\item Each service may be implemented as different components. The components
  communicate with each other using a \cola{message queue}.
\end{itemize}

\subsubsection{Keystone - identity management}

\cSay{ Keystone is the identity management service. It's the simplest service in OpenStack.}

It provides a REST API for authentication and authorization. It also provides a
service catalog, which is a list of all the services.

\dSay{ Why is it keeping it ?}

\cSay{ I think probably because it needs to know which services are accessible for a user anyway.}

\subsubsection{Swift - object storage}


\cSay{ Swift is the object storage service (an object store). To store an object, it splits the object into chunks and stores them in different containers redundantly.}

Some of the benefits of this design are:

\begin{itemize}
\item It has no central brain, and indicates no \Cola{Single Point of Failure (SPOF)}.
\item It has \cola{auto-revovery}.
\item It has inexpensive hardware that can be used for redundant storage clusters.
\end{itemize}

\dSay{ Wow, \cola{auto-recovey} is cool.}

\subsubsection{Cinder - block storage}

\dSay{ What if I just want a block of bytes ? For example, for the volume of a VM.}

\cSay{ Then you can use Cinder. It provides raw volumes that can be used as hand disks in VMs.}

Some of the features of Cinder are:

\begin{itemize}
\item You can create snapshots of volumes.
\item You can create backups of volumes.
\end{itemize}

Also, like Keystone, different storage backends can be plugged into Cinder such
as from IBM, NetApp, Nexenta, and VMware.

\dSay{ What are these ?}

\cSay{ I don't know. I think they are companies that provide storage....}

\begin{tcolorbox}
\cSay{ Cinder replaces the old \Cola{Nova Volume service}. }
\end{tcolorbox}

\subsubsection{Manila - file share (since \cola{Juno})}

\cSay{ Manila is the file share service. It provides a remote file system. In
  operation, it resembles the \Cola{Network File System (NFS)} or \Cola{SAMBA}
  storage service that you can find in Linux.}


\dSay{Oh, I know SAMBA. I remember it's how linux can access windows file.}
\cSay{Yes, it's a file sharing protocol.}


In contrast to Cinder, it resembles the \Cola{Storage Area Network (SAN)}
service. In fact, NFS and SAMBA or the \Cola{Common Internet File System (CIFS)}
are supported as backend drivers. Manila provides the orchestration of shares on
the share services.

\dSay{What do you mean by \cola{orchestration of shares} ?}

\cSay{ I think it means that it will take care of the shares when they are read and written by different services.}

\dSay{Oh, so what's the difference between Swift, Cinder and Manila ?}

\cSay{ Let's see a table:}

\begin{table}[htbp]
  \centering
  \begin{tabularx}{0.8\textwidth}{XXXX}
    \textbf{Specification} & \textbf{Swift} & \textbf{Cinder} & \textbf{Manila} \\
    \hline
    \textbf{Access mode} & REST API & Block device & File system \\
    \textbf{Multi-access} & \emoji{check-mark-button} & \emoji{cross-mark} & \emoji{check-mark-button} \\
    \textbf{Persistent} & \emoji{check-mark-button} & \emoji{check-mark-button} & \emoji{check-mark-button} \\
    \textbf{Accessibility} & Anywhere & Within single VM & Within multiple VMs \\
  \end{tabularx}
\end{table}

\subsubsection{Nova - compute service}
\leftSay{\svgOs{nova}}{My name is \Cola{Nova}. I am the compute service, the most complex service in OpenStack.}

\dSay{Wait... I remember you said that Nova is replaced by Cinder ?}

\cSay{ Only the \Cola{volume service }is replaced by Cinder. }

\dSay{Oh, I see. So how it's complex ?}

\cSay{ First, it needs to interact with many other services. Second, its internal components are complex, because it needs to respond to user requests for running VMs.}

Let's decompose it into its components:

\begin{description}
\item[nova-api] : It accepts and responds to user requests of creating instances
  (VMs) via the OpenStack API or the EC2 API.
\item[nova-compute] : It creates and terminates VMs via the hypervisor's APIs
  (XenAPI for XenServer, libvirt for KVM and the VMware API for VMware).
\item[nova-network] : It provides network connectivity for VMs. It's deprecated
  in favor of Neutron \emoji{litter-in-bin-sign}.
\item[nova-scheduler] : It schedules VMs to run on different compute nodes.
  (\emoji{parrot} : So here's where OpenStack find the best node to run a VM ?,
  \emoji{turtle} : Yes).
\item[nova-conductor] : It provides database access for the other components.
  (\emoji{parrot} : Why bother adding access control ? \emoji{turtle} : This is
  for security. If some nodes are compromised, we can't just let them access the
  database however they want).
\end{description}

\subsubsection{Neutron - networking services}


\rightSay{\svgOs{neutron}}{
  My name is \Cola{Nova}. I am the compute service, the most complex service in OpenStack.
  My name is \Cola{Neutron}.I provide a \Cola{Network
    as Service (NaaS)} capability between \cola{interface devices (routers,
    switches, load balancers, VPNs, firewalls)} managed by other OpenStack
  services (such as Nova) or external networks.
}

\cSay{ \Cola{Neutron} has the following features:}

\begin{itemize}
\item It allows users to create their own networks and attach interfaces to them.
\item Its backend is extensible, so it can take advantage of commodity gear or
  vandor-supported equipment.
\end{itemize}

Neutron has three main components:

\begin{description}
\item[server] : It accepts API requests and routes them to the appropriate
  \cola{plugin} for action.
\item[plugins] : They perform the actual work for the orchestration of backend devices such as
  \begin{itemize}
  \item plugging in or unplugging ports
  \item creating networks and subnets
  \item IP addressing.
  \end{itemize}
\item[agents] : They run on compute and network nodes. They receive commands
  from the plugins on the server and bring the changes into effect on the
  individual nodes. (\emoji{parrot}: Oh, so agent is like a client ?
  \emoji{turtle}: Yes).

  There're different types of agents. They provide different services. For example:
  \begin{description}
  \item[L3 agents] : They provide routing services.
  \item[Open vSwitch agents] : They provide layer 2 connectivity, by plugging
    and unplugging ports onto \Cola{Open vSwitch(OVS)} bridges.
  \end{description}
  \emoji{parrot}: What is OVS ? \emoji{turtle}: It's a virtual switch.

\end{description}


\section{Networking requirements}

\cSay{
  Due to the use of containers to isolate the OpenStack services, special network
  configuration is needed. In particular \Cola{OpenStack Ansible} uses
  \Cola{linux bridges} to provide network connectivity to the LXC containers.
}

\dSay{What is a linux bridge ?}

\cSay{It's a virtual switch that can be used to connect multiple network
  interfaces together. You can see what are on your system by running the command
  \texttt{ip link show}.
}

\end{document}

% Local Variables:
% TeX-engine: luatex
% TeX-command-extra-options: "-shell-escape"
% TeX-master: "m.tex"
% End: